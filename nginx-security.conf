
# Hide nginx version
server_tokens off;

# Prevent access to hidden files
location ~ /\. {
    deny all;
    access_log off;
    log_not_found off;
}

# Prevent access to backup files
location ~ ~$ {
    deny all;
    access_log off;
    log_not_found off;
}

# Prevent access to sensitive files
location ~* \.(conf|sql|log|bak|old|tmp)$ {
    deny all;
    access_log off;
    log_not_found off;
}

# Block common attack patterns
location ~* (wp-admin|wp-login|phpmyadmin|admin|login\.php) {
    deny all;
    access_log off;
    log_not_found off;
}

# Buffer overflow protection
client_body_buffer_size 1K;
client_header_buffer_size 1k;
client_max_body_size 10M;
large_client_header_buffers 2 1k;

# Timeout protection
client_body_timeout 10;
client_header_timeout 10;
keepalive_timeout 5 5;
send_timeout 10;
